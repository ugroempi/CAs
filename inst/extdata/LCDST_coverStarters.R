## copy-pasted from Lobb et al. 2012 (LCDST)
##   replaced oo_0 with 100+v-1, ..., oo_f-1 with 100+v-f
## only included cases that are used with group Z_v-f
## first list level: v
## second list level: k
## expanded with further v on Sep 2 2025

LCDSTStarters <- list(
  '3' = list('5'=c(102,0,1,1,0)),
  '4' = list('6'=c(103,0,1,1,2,1),
             '7'=c(103,2,1,2,2,1,2),
             '9'=c(103,102,1,0,1,1,102,103,0)),
  '5' = list('7'=c(104,2,3,1,1,0,1),
             # '8'=c(104,2,3,1,1,0,1),  ## distinct, k-1 elements, same as seven
             # can omit, as covered in CS_MS
             '10'=c(103,103,2,1,104,1,104,0,1,1)),
  '6' = list('9'=c(105,2,4,4,2,1,2,1,3)),
  '7' = list('10'=c(106,0,1,0,3,5,4,2,0,0),
             '13'=c(106,3,106,105,3,2,1,105,0,2,0,1,1),
             '14'=c(106,1,4,0,2,1,4,4,4,4,106,105,0,105),
             '15'=c(105,105,3,106,4,1,2,106,2,2,NA,2,2,1,4),
             '17'=c(104,104,1,105,3,1,2,106,1,106,3,106,3,2,2,105,3)),
  '8' = list('11'=c(107,0,3,0,6,4,1,3,0,1,1),
             ## 13 has to be figured out
             ## is there are group for 8 that does not have a single primitive only?
             ## x x^2 x xy xy 107 1 x^y x^2 107 106 1 106
             ##           in {x, yx^3 = y^2 = 1, yxy = x^2}
             '15'=c(0,1,3,3,1,2,5,106,0,0,5,106,107,0,107),
             '16'=c(107,106,2,107,1,106,5,5,1,1,2,0,2,5,3,2),
             '18'=c(107,107,1,3,3,106,1,106,0,4,0,105,1,0,105,0,2,0),
             '19'=c(107,107,0,3,106,0,105,4,4,0,NA,0,2,1,105,0,106,3,4),
             '20'=c(107,107,1,106,0,0,1,106,0,105,4,3,1,3,105,3,0,2,3,0)),
  '9' = list('13'=c(108,7,0,3,2,4,1,4,4,0,1,1,7),
             '16'=c(3,108,3,2,107,6,5,5,1,6,3,5,6,108,4,107),
             '17'=c(2,4,108,3,4,6,6,3,6,6,4,0,108,6,5,107,107),
             '19'=c(108,108,3,107,2,106,3,2,2,107,3,0,1,5,3,1,3,106,0),
             '20'=c(108,108,5,4,107,2,107,1,2,106,5,1,NA,1,5,2,106,3,3,5),
             '21'=c(108,108,3,107,4,2,3,107,3,106,1,3,2,5,4,4,NA,1,0,106,2),
             '22'=c(108,108,4,107,3,2,2,107,3,106,5,1,2,5,106,5,NA,0,3,3,4,2)),
  '10' = list( ## omit 14 (group Z3xZ3), 16 (distinct, k-1, not better than MS), 25 to 27 (f=4)
             '15'=c(109,4,6,1,6,3,7,8,2,0,1,5,4,6,6),
             '18'=c(109,5,3,3,109,3,6,3,4,4,0,3,5,0,7,108,2,108),
             '20'=c(109,109,5,108,0,5,4,108,5,107,0,3,5,2,107,0,1,4,4,4),
             '21'=c(109,108,3,107,0,6,4,107,0,108,109,6,5,3,0,2,5,0,0,1,0),
             '22'=c(109,109,3,108,4,0,6,108,2,107,3,2,3,5,107,4,NA,5,3,3,3,0),
             '23'=c(109,109,4,108,6,6,3,1,4,108,5,4,107,4,NA,4,107,5,0,1,6,NA,4),
             '25'=c(109,109,4,108,1,107,3,1,2,108,5,0,2,106,2,1,107,2,106,2,5,106,5,3,3),
             '26'=c(109,0,1,108,109,4,107,3,5,5,2,0,106,107,106,106,1,5,4,5,1,0,2,1,108,5),
             '27'=c(109,109,4,108,1,4,3,108,5,107,4,2,106,0,1,5,5,5,1,107,1,2,0,3,0,106,1)),
  '11' = list('16'=c(110,2,6,7,2,1,4,5,3,3,6,2,9,9,0,2),
              '17'=c(110,1,0,5,5,8,2,4,4,1,2,6,2,5,3,2,0),
              '19'=c(3,2,7,110,5,4,8,0,0,109,110,4,7,1,3,0,3,1,109),
              '20'=c(110,109,3,110,1,109,6,3,5,2,5,4,4,8,6,2,5,1,2,2),
              '22'=c(110,110,5,109,4,7,1,109,3,108,0,1,0,5,108,1,3,7,4,2,7,7),
              '23'=c(110,109,1,108,2,6,6,108,7,109,110,3,2,1,2,6,4,1,0,2,5,0,4),
              '25'=c(110,110,0,109,0,108,0,3,1,109,2,4,4,107,1,2,108,6,107,5,0,107,5,2,1),
              '26'=c(110,1,5,109,110,3,108,4,0,0,5,0,107,108,107,107,1,1,5,3,2,1,0,1,109,0),
              '27'=c(110,110,0,109,4,3,4,109,4,108,5,4,107,2,0,2,3,6,6,108,4,3,3,0,5,107,6)),
  '12' = list(#'17'=c(1,9,6,2,6,2,2,3,4,1,4,9,7,6,1,5,7,111), ## does not cover
              '18'=c(111,8,8,3,1,1,9,0,1,5,8,9,8,7,8,9,3,10),
              '19'=c(111,0,1,10,2,1,5,3,9,1,1,1,6,8,9,5,9,7,4),
              # '20'=c(111,0,1,10,2,1,5,3,9,1,1,1,6,8,9,5,9,7,4), ## distinct --> CS_CMMSSY
              '22'=c(111,110,7,111,0,110,9,2,1,7,2,8,6,3,0,2,6,4,4,1,0,1),
              '24'=c(111,110,1,109,4,3,4,109,7,110,111,5,5,7,2,2,7,3,3,1,2,7,1,7),
              '25'=c(111,110,6,109,1,4,0,109,2,110,111,2,1,3,0,7,7,8,5,4,1,4,7,2,1),
              ## '27'=c(111,111,6,110,4,4,4,1,105,109,0,1,108,7,4,2,1,4,7,109,0,4,3,0,2,108,0), does not cover
              '28'=c(111,111,6,110,2,2,7,7,6,110,4,109,5,2,108,2,5,3,109,5,3,5,6,7,1,5,108,3),
              '29'=c(111,111,2,110,2,6,7,110,2,109,3,2,4,6,5,3,3,108,5,0,109,2,108,3,0,5,4,4,1),
              '32'=c(107,107,5,108,5,4,3,108,4,109,4,2,110,1,111,5,6,0,2,109,3,111,4,5,3,6,6,110,4,1,111,3)),
  '13' = list(# omitted 18 distinct relative 1
              '19'=c(4,11,0,3,2,0,5,7,4,0,4,10,10,9,5,9,3,3,112),
              '20'=c(112,10,6,6,0,10,0,9,5,4,5,4,7,2,0,5,9,1,10,2),
              '21'=c(112,5,0,8,8,10,5,8,9,3,2,2,11,9,2,0,3,0,9,1,2),
              '24'=c(112,111,10,112,7,111,10,10,3,6,5,2,7,7,4,2,5,1,9,10,9,9,0,6),
              '28'=c(112,112,5,111,2,2,1,2,4,111,8,110,2,8,109,1,2,5,110,0,6,1,4,4,0,7,109,5),
              '29'=c(112,112,5,111,5,5,6,111,0,110,8,0,3,4,4,8,2,109,1,3,110,0,109,8,6,5,2,8,4),
              '30'=c(112,112,4,111,4,1,6,111,4,110,5,4,109,1,1,7,0,2,2,110,1,0,4,5,3,109,8,2,NA,2),
              '32'=c(108,108,3,109,0,6,2,109,4,110,3,6,111,0,112,5,0,1,1,110,4,112,4,3,4,1,2,111,1,3,112,0),
              '33'=c(108,108,3,109,2,110,3,5,7,109,2,1,111,1,2,6,1,112,0,3,110,7,111,5,1,112,3,0,0,112,6,4,1),
              '34'=c(108,108,0,109,4,1,110,2,2,5,7,111,1,110,1,111,1,4,6,1,1,109,7,112,2,6,112,4,5,6,4,3,112,5)),
  '14' = list(# omitted 19 distinct relative (1)
              '21'=c(11,8,12,2,10,2,1,2,8,10,4,8,11,7,4,9,7,12,4,4,113),
              '22'=c(5,1,4,12,8,6,8,12,12,10,4,11,1,1,3,9,1,11,10,2,3,113),
              '23'=c(113,10,1,3,3,4,1,0,9,1,9,0,0,0,7,3,9,2,1,4,11,9,6),
              '25'=c(113,5,8,1,11,10,4,1,4,12,6,8,1,2,9,7,6,3,8,4,2,9,9,2,6),
              '30'=c(110,110,4,111,1,0,2,111,1,112,9,7,113,9,4,2,1,8,6,112,0,4,0,3,1,113,0,4,4,5),
              '31'=c(113,113,6,112,7,2,9,112,3,111,7,6,1,2,110,7,0,6,6,8,9,111,8,6,6,1,8,1,5,110,1),
              '33'=c(109,109,4,110,7,111,0,6,0,110,8,7,112,8,8,4,2,113,8,7,111,1,112,5,8,113,6,1,6,113,1,3,4),
              '34'=c(109,109,8,110,6,1,111,3,5,7,8,112,7,111,3,112,1,1,1,7,5,110,1,113,6,2,113,3,2,6,7,1,113,8),
              '35'=c(109,109,3,1,110,5,111,4,4,112,8,110,8,7,4,113,4,2,5,111,3,112,8,0,8,113,8,4,0,7,113,0,6,1,3),
              '36'=c(109,109,7,110,1,8,111,3,2,6,0,1,110,7,112,2,8,6,112,5,6,6,0,7,113,3,111,3,3,5,8,113,7,0,5,2),
              '37'=c(109,109,3,110,3,3,8,110,6,111,7,2,0,3,111,2,4,112,5,7,113,4,6,113,3,6,7,8,5,112,5,113,7,0,2,6,5),
              '38'=c(109,109,5,110,3,3,3,2,6,8,111,5,3,2,110,0,111,8,0,112,8,0,4,0,7,1,113,2,3,NA,8,3,1,7,113,3,112,7),
              '39'=c(109,109,5,110,1,5,111,3,8,1,1,7,1,112,2,111,4,7,3,7,NA,3,0,6,4,5,110,0,113,1,4,3,113,4,112,7,5,5,8)),
  '15' = list('24'=c(8,7,7,2,6,2,7,13,10,6,2,4,6,0,1,6,4,11,10,13,5,7,1,114),
              '25'=c(114,7,5,9,6,7,7,9,3,10,10,10,1,0,6,9,5,3,8,0,3,9,12,7,1),
              '26'=c(114,8,2,7,7,12,11,4,6,6,4,2,5,2,0,12,7,3,5,9,10,11,7,5,2,8),
              '27'=c(114,5,1,12,6,10,11,3,13,10,5,4,9,12,0,1,2,0,9,0,6,13,12,12,8,7,4),
              '32'=c(111,111,4,112,1,0,3,112,2,113,9,9,114,4,0,5,5,9,0,113,10,8,10,0,2,9,3,114,0,6,7,4),
              '33'=c(114,114,7,113,1,7,1,113,10,112,0,1,111,5,8,4,4,6,10,112,4,5,3,8,10,111,1,0,6,3,0,0,10),
              '34'=c(114,114,0,113,5,10,1,113,6,112,2,9,10,3,112,4,111,3,5,7,4,10,2,5,8,6,111,10,10,1,1,2,1,9),
              '36'=c(110,110,3,111,5,8,112,9,9,3,7,0,111,5,113,0,7,8,113,4,4,5,7,3,114,7,112,3,8,7,6,114,5,3,5,4),
              '37'=c(110,110,6,111,3,4,4,111,0,112,3,4,8,0,112,6,9,113,4,8,114,5,0,114,9,5,3,2,4,113,2,114,4,1,6,1,1),
              '38'=c(110,110,3,111,6,4,4,3,4,8,112,9,3,9,111,1,112,9,2,113,2,4,3,0,3,1,114,0,6,NA,1,3,2,7,114,4,113,7),
              '39'=c(110,110,1,111,2,4,112,2,0,5,9,7,7,113,3,112,1,5,5,4,NA,0,7,0,1,5,111,9,114,6,2,5,114,6,113,0,5,9,7),
              '40'=c(110,110,1,111,2,4,2,111,6,112,4,3,113,0,NA,6,4,7,0,112,5,114,0,5,3,4,6,113,9,1,4,8,6,6,6,9,6,2,114,8)),
  '16' = list('25'=c(115,4,12,6,10,10,6,13,14,5,8,7,9,8,0,5,14,12,14,6,4,1,7,2,6),
              '27'=c(115,0,2,3,7,14,13,9,4,14,11,12,5,6,0,14,0,13,4,0,5,5,4,7,7,14,3),
              '28'=c(115,1,5,13,7,3,11,10,5,10,9,10,2,5,10,1,12,4,6,14,1,3,0,4,6,12,12,10),
              '29'=c(115,1,7,0,3,0,5,1,14,9,11,13,1,11,11,5,12,14,3,3,8,6,14,4,12,11,12,4,5),
              '36'=c(111,111,1,112,7,6,113,10,2,7,2,4,112,8,114,4,9,5,114,4,2,7,4,10,115,3,113,5,6,10,0,115,9,9,9,2),
              '38'=c(111,111,9,112,3,1,1,10,10,2,112,10,3,113,4,7,114,6,8,5,10,1,115,5,113,0,115,6,3,7,5,0,6,7,6,2,114,8),
              '39'=c(111,111,3,112,1,3,113,9,1,9,2,2,8,114,0,113,5,1,10,0,NA,2,5,5,5,1,112,6,115,6,9,9,115,3,114,0,5,7,6),
              '40'=c(111,111,6,112,4,2,4,112,7,113,3,2,114,6,NA,4,9,10,4,113,0,115,7,4,8,8,8,114,7,8,10,5,1,7,3,6,8,2,115,10)),
  '17' = list('31'=c(116,11,6,10,10,7,0,1,3,13,2,8,14,4,12,6,4,15,9,5,8,6,14,13,5,13,6,4,11,0,9),
              '32'=c(116,6,13,12,2,2,5,8,6,8,10,13,3,12,8,6,0,12,0,7,11,7,13,2,10,9,4,5,2,12,6,0),
              '39'=c(112,112,6,113,4,1,3,113,1,114,11,3,9,7,0,8,9,10,9,115,11,116,0,5,0,5,114,0,8,9,4,2,116,7,115,1,9,0,0),
              '40'=c(112,112,11,113,8,7,1,113,0,114,1,10,115,11,11,7,2,4,2,114,3,116,7,11,9,7,9,115,9,11,7,3,6,7,0,10,3,6,116,1),
              '41'=c(112,112,1,113,11,5,1,113,3,114,4,5,8,8,114,7,115,3,1,6,7,6,NA,3,10,116,5,11,115,6,3,7,9,3,4,116,4,4,9,11,10),
              '42'=c(112,112,5,113,2,4,11,113,0,114,5,1,5,10,114,3,7,115,10,10,10,1,4,116,8,NA,0,5,6,0,4,4,115,6,5,116,4,4,2,8,5,4),
              '44'=c(111,111,3,112,1,7,113,8,2,4,5,7,0,3,114,1,8,7,7,115,8,113,7,115,4,3,114,6,116,6,4,8,3,4,10,6,3,112,8,116,1,9,116,6)),
  '18' = list('32'=c(117,14,5,0,3,5,3,12,2,9,8,14,10,13,13,6,10,0,11,12,3,1,5,8,16,13,1,11,9,0,5,10),
              '34'=c(117,5,3,13,5,8,1,8,4,13,2,12,14,4,8,7,4,0,5,7,16,2,14,1,15,6,12,12,14,11,5,15,16,16),
              '40'=c(117,117,4,116,9,12,0,116,8,115,6,6,3,2,115,4,114,5,0,6,0,12,11,0,4,12,114,1,5,13,9,2,2,1,1,6,7,1,8,10),
              '42'=c(113,113,11,114,4,8,0,114,11,115,8,8,2,7,115,4,2,116,10,0,11,0,6,117,1,6,5,10,11,7,3,11,116,4,1,117,4,11,6,12,5,10),
              '45'=c(112,112,6,113,6,4,2,113,5,10,114,6,115,10,1,4,5,116,5,6,115,0,5,117,0,7,6,0,8,117,5,0,116,10,114,5,8,3,3,8,0,9,11,117,9),
              '46'=c(112,112,4,113,5,3,10,113,8,4,114,6,0,115,1,3,7,4,3,3,1,2,116,6,115,6,8,9,7,2,114,8,117,2,3,9,6,117,1,8,116,10,3,7,10,3),
              '47'=c(112,112,5,113,11,1,0,113,10,114,5,9,115,8,4,116,0,117,10,5,3,5,114,8,117,6,1,8,5,4,3,117,7,116,11,9,7,0,9,115,6,9,3,4,5,1,1)),
  '19' = list('36'=c(118,7,9,7,2,5,5,5,16,1,6,7,0,11,5,10,2,5,10,16,17,13,2,0,3,17,13,12,16,6,10,7,1,9,0,7),
              '46'=c(113,113,4,114,0,1,3,114,4,11,115,2,8,116,9,9,6,11,5,11,2,3,117,8,116,6,8,3,3,7,115,4,118,4,3,11,4,118,3,6,117,11,3,12,10,5),
              '47'=c(113,113,12,114,3,4,3,114,11,115,9,5,116,0,3,117,8,118,1,12,0,12,115,6,118,11,9,4,11,0,10,118,5,117,7,2,8,4,9,116,10,10,1,0,9,10,10),
              '48'=c(113,113,9,114,11,8,11,114,11,3,5,1,3,2,4,8,115,5,0,116,1,2,117,7,115,6,12,1,5,116,5,118,1,3,12,10,117,0,0,7,11,11,118,0,0,2,8,2)),
  '20' = list('38'=c(119,16,13,7,14,13,12,17,8,15,9,15,15,7,5,17,7,16,0,18,12,1,7,9,5,6,13,0,16,6,8,3,16,1,7,13,14,18),
              '39'=c(119,16,13,6,6,0,7,1,15,16,2,15,11,15,6,18,0,9,4,0,2,1,7,12,12,7,12,16,14,11,3,8,9,14,11,8,16,0,9),
              '47'=c(115,115,12,116,13,1,14,116,11,117,12,5,8,11,117,10,118,1,0,7,12,9,6,119,13,3,118,3,0,6,13,14,12,4,2,12,1,3,12,14,10,119,4,4,9,8,4),
              '49'=c(114,114,4,115,6,2,3,115,2,116,4,4,7,12,117,2,118,9,12,7,6,3,12,12,117,3,5,116,6,119,11,9,2,11,1,118,12,13,4,4,4,119,13,3,13,3,13,5,13),
              '50'=c(114,114,11,115,7,3,1,115,12,116,11,0,117,9,6,3,6,8,8,10,1,8,1,118,2,117,9,1,116,5,119,8,13,118,11,5,1,8,3,NA,9,13,10,0,13,119,8,1,2,7),
              # the vector has one element too many and does not yield 52 columns - the mistake is unclear
              #'51'=c(114,114,5,115,6,1,0,115,1,1,116,0,4,117,0,118,2,12,6,9,6,119,10,7,0,11,13,6,117,4,2,7,0,116,7,13,11,11,9,10,8,12,119,12,2,1,7,NA,12,9,118,1),
              '54'=c(113,8,114,113,115,12,10,3,116,10,117,11,9,10,114,7,3,10,1,11,12,118,4,2,2,8,6,3,115,119,3,6,6,9,12,7,12,9,8,116,5,4,7,118,10,10,12,119,117,119,7,0,3,7),
              '55'=c(113,113,12,114,8,12,8,115,0,116,10,117,1,1,8,11,117,7,118,7,119,2,1,12,2,12,119,9,12,119,12,9,11,116,8,8,1,9,6,118,4,12,12,9,5,9,114,0,115,2,1,6,4,5,2),
              '56'=c(113,113,5,2,114,5,10,10,115,5,116,1,5,8,117,5,1,5,6,118,8,4,8,11,11,9,7,9,7,5,0,6,119,10,12,119,6,11,115,8,3,3,118,6,5,5,116,10,114,0,5,119,3,117,3,10),
              '57'=c(113,113,0,114,6,1,8,4,4,8,114,5,1,115,6,1,116,12,117,7,4,8,4,5,0,6,118,2,9,12,118,4,115,0,11,8,3,5,0,5,4,9,117,8,119,2,0,4,6,2,10,11,116,1,12,119,1)),
  '21' = list('42'=c(120,8,13,2,1,13,17,19,14,15,1,15,12,9,1,1,17,11,11,9,16,9,19,10,3,13,1,2,6,4,1,11,19,2,15,1,8,11,7,8,18,14),
              '54'=c(114,6,115,114,116,11,8,4,117,11,118,8,9,3,115,0,11,10,7,4,11,119,5,3,4,8,4,8,116,120,8,8,1,3,13,9,0,6,8,117,2,2,5,119,4,10,0,120,118,120,1,11,9,4),
              '55'=c(114,114,13,115,12,5,4,116,5,117,12,118,3,3,13,1,118,3,119,13,120,11,1,1,5,8,120,1,6,120,5,13,12,117,8,0,2,0,1,119,4,10,6,7,13,8,115,7,116,0,4,9,6,3,3),
              '56'=c(114,114,11,5,115,1,5,13,116,13,117,2,0,11,118,3,12,7,13,119,12,13,13,4,7,6,2,6,13,11,8,10,120,8,7,120,2,6,116,3,9,1,119,9,1,4,117,7,115,1,0,120,7,118,10,5),
              '57'=c(114,114,8,115,9,12,5,1,13,12,115,9,11,116,2,7,117,13,118,9,1,4,9,1,1,13,119,6,13,6,119,7,116,7,11,1,10,3,7,4,4,11,118,9,120,2,13,0,8,9,12,3,117,3,2,120,12),
              '58'=c(114,114,8,115,1,116,12,117,5,1,1,8,5,7,6,7,NA,5,2,9,115,6,5,116,8,6,3,118,6,4,10,119,0,2,4,8,120,2,8,118,2,13,3,11,5,2,5,10,13,4,120,6,119,11,6,117,9,1),
              '59'=c(114,114,8,115,9,11,8,1,3,10,11,6,3,116,8,117,1,118,10,12,13,7,8,11,11,118,0,4,7,115,9,1,116,9,4,NA,4,6,117,3,9,0,119,12,9,120,3,119,2,1,8,8,3,1,12,7,120,11,7),
              '60'=c(114,114,6,115,1,12,8,9,7,115,4,3,116,7,117,4,6,9,12,9,13,0,8,118,7,12,7,7,7,11,4,119,13,116,2,4,NA,0,119,9,3,118,2,12,4,6,120,7,12,12,120,1,6,11,9,1,11,13,117,5)),
  '22' = list('44'=c(121,7,14,8,4,14,10,1,10,4,4,14,9,15,7,16,12,8,9,12,16,17,17,5,8,1,8,17,19,17,4,8,3,2,12,5,8,19,16,0,18,6,16,1),
              '54'=c(116,116,15,117,15,1,3,117,15,118,7,0,4,9,118,10,119,13,4,5,11,7,120,10,10,7,1,6,14,13,8,3,6,3,12,6,121,6,10,119,3,15,9,15,5,4,121,13,120,3,13,14,12,7),
              '57'=c(115,115,4,116,8,1,10,8,7,4,116,4,1,117,6,12,118,6,119,5,13,5,6,7,13,9,120,10,5,8,120,4,117,9,5,9,5,9,8,0,3,6,119,8,121,10,0,5,14,0,0,0,118,1,3,121,7),
              '58'=c(115,115,6,116,12,117,11,118,6,14,6,4,10,11,8,1,NA,12,6,5,116,13,4,117,13,9,8,119,6,5,8,120,14,1,11,8,121,6,13,119,12,3,7,14,3,10,1,4,2,7,121,13,120,2,4,118,1,1)),
  '23' = list('58'=c(116,116,9,117,4,4,0,3,117,10,9,12,1,15,15,10,15,3,12,13,118,5,2,119,3,13,120,11,13,9,10,1,121,5,5,122,12,5,0,120,9,118,13,121,12,7,2,9,14,122,11,119,0,14,12,4,7,13))
)

# initial implementation for f<=3 could work with eCAN
eCANhilf <- function(k,v){
  if (v==1) return(1) else return(eCAN(2,k,v)$CAN)
}
eCANvec <- Vectorize(eCANhilf)
eCANConstr <- function(k,v){
  if (v==1) return("---") else return(eCAN(2,k,v)$Source)
}
eCANConstr <- Vectorize(eCANConstr)
bestNvec <- function(k, v, ...) mapply(function(obj1, obj2)
    unname(ifelse(obj2==1, 1, bestN(2,obj1,obj2, ...))),
    k, v)
bestConstr <- function(k, v, ...) mapply(function(obj1, obj2)
  unname(ifelse(obj2==1, 1, names(bestN(2,obj1,obj2, ...)))),
  k, v)


## obtain realistic N via applying function bestN for the CA(2,k,f)
## implies that updates are needed if best designs for relevant cases are added
##     to the package
LCDSTCombis <- data.frame(
  v=(v <- rep(as.numeric(names(LCDSTStarters)), lengths(LCDSTStarters))),
  k=(k <- unlist(lapply(LCDSTStarters, function(obj) as.numeric(names(obj))))),
  f=(f <- unlist(lapply(LCDSTStarters, function(obj) sapply(obj,
                        function(obj2) length(unique(obj2[which(obj2>100)])))))),
  NAs=(NAs <- unlist(lapply(LCDSTStarters, function(obj) sapply(obj,
                                              function(obj2) sum(is.na(obj2)))))),
  N = (v-f)*k + unname(B <- bestNvec(k,f)),
  ingredient = bestConstr(k,f),
  # N_withoutInternet = (v-f)*k + bestNvec(k,f, internet=FALSE),
  # no longer needed, as never different from the with internet variant
  N_eCANbased = (v-f)*k + eCANvec(k,f),
  eCANconstr = eCANConstr(k, f)
)

rownames(LCDSTCombis) <- NULL

## verify coverage, PCA status and dimensions
# PCA_k1 <- rep(0, nrow(LCDSTCombis))
# for f=1, k1=k-1 has been verified
for (i in 1:nrow(LCDSTCombis)){
  print(i)
  if (!all(coverage(D<-CS_LCDST(LCDSTCombis$k[i], LCDSTCombis$v[i]), 2)==1)){
    print(paste0("coverage violated for k=", LCDSTCombis$k[i], " with v=", LCDSTCombis$v[i]))
    break
    }
  if (!(nrow(D)<=LCDSTCombis$N[i] && ncol(D)>=LCDSTCombis$k[i])) break
  if (f[i]>3) print(paste0("excess size: ", LCDSTCombis$N[i] - LCDSTCombis$N_eCANbased[i]))
  # if (f[i]==1){
  #   hilf <- CA_to_PCA(D, tryhard=TRUE)
  #   hilf <- try(attr(hilf,"PCAstatus")$k1)
  #   if (!"try-error" %in% class(hilf) && length(hilf)>0) PCA_k1[i] <- hilf
  # }
}

## did not attempt calculation for f>1

for (i in 1:nrow(LCDSTCombis)){
if (f[i]==2){
  D <- CS_LCDST(k[i],v[i])
  hilf <- CA_to_PCA(D, tryhard=TRUE)
  hilf <- try(attr(hilf,"PCAstatus")$k1)
  if (!"try-error" %in% class(hilf) && length(hilf)>0) PCA_k1[i] <- hilf
}}

# save(LCDSTCombis, file="d:/rtests/CAs/data/LCDSTCombis.rda", compress="xz")
# save(LCDSTStarters, file="d:/rtests/CAs/data/LCDSTStarters.rda", compress="xz")


#
# hilf <- LCDSTCombis
# hilfStarters <- LCDSTStarters
# vnams <- names(hilfStarters)
# for (i in 1:length(hilfStarters)){
#   v <- as.numeric(vnams[i])
#   knams <- names(hilfStarters[[i]])
#   print(v)
#   for (j in 1:length(hilfStarters[[i]])){
#     kc <- knams[j]
#     print(kc)
#     f <- hilf$f[which(hilf$v==v & hilf$k==as.numeric(kc))]
#     print(f)
#     if (!f==1) hilfStarters[[i]][[kc]] <- NULL
#   }}
# hilfStarters[["23"]] <- NULL
# hilf <- hilf[hilf$f==1,]
#
# firstnotInf <- lapply(hilfStarters, function(obj) sapply(obj, function(obj2) obj2[1]<100))
# for (i in 1:length(hilfStarters))
#   for (j in 1:length(hilfStarters[[i]])){
#     temp <- hilfStarters[[i]][[j]]
#     if (firstnotInf[[i]][[j]]){
#       temp <- c(temp[length(temp)], temp[-length(temp)])
#     }
#     temp[1] <- Inf
#     hilfStarters[[i]][[j]] <- temp
#   }
#
# vnams <- names(hilfStarters)
# for (i in 1:length(hilfStarters)){
#   print(i)
#   knams <- names(hilfStarters[[i]])
#   for (j in 1:length(hilfStarters[[i]])){
#     print(j)
#     print(coverage(CS_CMMSSY(as.numeric(knams[j])+1,
#                                 as.numeric(vnams[i]),
#                                 starter=hilfStarters[[i]][[j]]),2))
#   }
# }
